<link rel="import" href="../environments/environment.html">
<link rel="import" href="../assets/libs/polymer/polymer.html">
<link rel="import" href="../assets/libs/app-route/app-route.html">
<link rel="import" href="../assets/libs/app-route/app-location.html">
<link rel="import" href="../assets/libs/iron-pages/iron-pages.html">
<link rel="import" href="../assets/libs/iron-ajax/iron-ajax.html">
<link rel="import" href="home/portfolio-home.html">

<dom-module id="portfolio-app">

  <template>

    <style>

      :host {
          display: flex;
          flex-direction: column;
      }

      header, iron-pages {
          padding: 1.6rem;
      }

    </style>

    <app-location route="{{route}}"></app-location>
    <app-route route="{{route}}" pattern="/:page" data="{{pageRouter}}" tail="{{categoryRoute}}"></app-route>
    <app-route route="{{categoryRoute}}" pattern="/:category" data="{{categoryRouter}}" tail="{{postRoute}}"></app-route>
    <app-route route="{{postRoute}}" pattern="/:post" data="{{postRouter}}"></app-route>

    <header>
      <a href="/">Home</a>
      <a href="/list/graphic-design">Graphic Design</a>
      <a href="/list/photography">Photography</a>
      <a href="/about">About</a>
    </header>

    <iron-pages selected="[[page]]" attr-for-selected="selected" selected-attribute="visible" fallback-selection="404" on-iron-select="listenerIronSelect">
      <portfolio-home selected="home"></portfolio-home>
      <portfolio-about selected="about"></portfolio-about>
      <portfolio-list selected="list" category="[[category]]"></portfolio-list>
      <portfolio-post selected="post" category="[[category]]" post="[[post]]"></portfolio-post>
    </iron-pages>

  </template>

  <script>

    Polymer({

      is: 'portfolio-app',

      behaviors: [

      ],

      properties: {
        page: {
          type: String,
          value: () => { return ``; },
        },
        category: {
          type: String,
          value: () => { return ``; },
        },
        post: {
          type: String,
          value: () => { return ``; },
        },
      },

      observers: [
        'observerRouterPage(pageRouter.page)',
        'observerRouterCategory(categoryRouter.category)',
        'observerRouterPost(postRouter.post)',
      ],

      listeners: {
        // 'on-selected-post': `listenerSelectedPost`
      },

      ready() {

      },

      attached() {

      },

      detached() {

      },


      /* OBSERVERS */
      observerRouterPage(page) {
        this.page = (page === '') ? 'home' : page;
      },

      observerRouterCategory(category) {
        if (category) this.set(`category`, category);
      },

      observerRouterPost(post) {
        if (post) this.set(`post`, post);
      },

      /* LISTENERS */
      listenerIronSelect(event) {
        const name = event.target.selected;
        const importHref = `${name}/portfolio-${name}.html`;
        this.importHref(this.resolveUrl(importHref), null, null, true);
      },

      /* FUNCTIONS */

    });

  </script>

</dom-module>